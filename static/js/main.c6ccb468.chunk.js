(this.webpackJsonpcvr_flyt_app=this.webpackJsonpcvr_flyt_app||[]).push([[0],{316:function(e,t){},367:function(e,t,a){e.exports=a(596)},372:function(e,t,a){},485:function(e,t,a){},513:function(e,t){},515:function(e,t){},548:function(e,t){},549:function(e,t){},593:function(e,t){},594:function(e,t){},596:function(e,t,a){"use strict";a.r(t);var n=a(0),r=a.n(n),l=a(18),s=a.n(l),o=(a(372),a(119)),i=a(320),c=a.n(i),u=a(74),d=a(75),m=a(83),h=a(84),p=a(89),g=a(85),f=a(28),v=a(90),b=a(59),k=a(167),E=a(666),y=a(653),w=a(677),O=a(8),j=a(672),C=a(668),D=a(646),S=a(339),F=a.n(S),x=a(346),T=a(679),L=a(91),M=a.n(L),N=(a(380),a(678)),R=a(658),_=a(341),I=a.n(_),Y=a(342),A=a.n(Y),V=a(343),P=a.n(V),W=a(344),q=a.n(W),B=a(212),K=a(35),U=a(669),z=a(651),H=a(667),G=a(51),J=a.n(G),$={width:"100%",height:"1200px"};window.geojsonLayer=void 0,window.lfMap=void 0;var Q=J.a.control({position:"bottomleft"});Q.onAdd=function(e){var t=J.a.DomUtil.create("div","legend");return t.innerHTML+="<h4>Signaturforklaring</h4>",t.innerHTML+='<i style="background:#0020d7"></i><span>NyStartet</span><br>',t.innerHTML+='<i style="background:#d79700"></i><span>Fraflyttet</span><br>',t.innerHTML+='<i style="background:#298b30"></i><span>Tilflyttet</span><br>',t.innerHTML+='<i style="background:#c10a0a"></i><span>Oph\xf8rt</span><br>',t};var X=function(e){function t(e){var a;return Object(m.a)(this,t),(a=Object(p.a)(this,Object(g.a)(t).call(this,e))).state={data:{},renderLegend:!1},a}return Object(v.a)(t,e),Object(h.a)(t,[{key:"renderMap",value:function(e){var t="d12107f70a3ee93153f313c7c502169a",a=J.a.tileLayer.wms("https://services.kortforsyningen.dk/topo_skaermkort",{layers:"dtk_skaermkort_daempet",token:t,format:"image/png",attribution:'&copy; <a target="_blank" href="https://download.kortforsyningen.dk/content/vilk%C3%A5r-og-betingelser">Styrelsen for Dataforsyning og Effektivisering</a>'}),n=J.a.tileLayer.wms("https://services.kortforsyningen.dk/service?request=GetCapabilities&servicename=dagi&service=WMS&version=1.1.1",{layers:"kommune",format:"image/png",token:t,transparent:!0});window.lfMap=J.a.map("map",{center:[55.876823,9.961644],zoom:8,layers:[a,n]}),J.a.control.scale().addTo(window.lfMap)}},{key:"renderFeatures",value:function(e){Q.addTo(window.lfMap);void 0!==window.geojsonLayer&&window.lfMap.removeLayer(window.geojsonLayer),window.geojsonLayer=J.a.geoJSON(e,{onEachFeature:function(e,t){t.bindPopup("<strong>"+e.properties.status+"</strong></br><hr>"+e.properties.navn+'</br><a href="https://datacvr.virk.dk/data/visenhed?enhedstype=produktionsenhed&id='+e.properties["p-nummer"]+'" target="_blank">Se mere her</a>')},pointToLayer:function(e,t){return J.a.marker(t,{icon:(a=e.properties.status,J.a.icon({iconUrl:function(e){switch(e){case"Tilflytter":return"img/t.png";case"Fraflytter":return"img/f.png";case"Nystartet":return"img/n.png";case"Oph\xf8rt":return"img/o.png"}}(a),shadowUrl:"img/shadow.png",iconAnchor:[16,37],shadowAnchor:[20,35],popupAnchor:[0,-30]}))});var a}}).addTo(window.lfMap);var t=function(e){var t=e.filter((function(e){return["Nystartet",""].includes(e.properties.status)}));return 0===t.length?null:t[0].geometry.coordinates}(e);t?window.lfMap.setView([t[1],t[0]],12):window.lfMap.fitBounds(window.geojsonLayer.getBounds())}},{key:"componentDidMount",value:function(){this.renderMap(this.props.data),this.props.data.length>0&&this.renderFeatures(this.props.data)}},{key:"componentDidUpdate",value:function(){console.log("componentdidupdate"),this.props.data.length>0?this.renderFeatures(this.props.data):console.log("props empty")}},{key:"renderMarkers",value:function(e){window.geojsonLayer=J.a.geoJSON(e,{onEachFeature:function(e,t){t.bindPopup("<strong>"+e.properties.status+"</strong></br><hr>"+e.properties.navn+'</br><a href="https://datacvr.virk.dk/data/visenhed?enhedstype=produktionsenhed&id='+e.properties["p-nummer"]+'" target="_blank">Se mere her</a>')},pointToLayer:function(e,t){return J.a.marker(t,{icon:(a=e.properties.status,J.a.icon({iconUrl:function(e){switch(e){case"Tilflytter":return"img/t.png";case"Fraflytter":return"img/f.png";case"Nystartet":return"img/n.png";case"Oph\xf8rt":return"img/o.png"}}(a),shadowUrl:"img/shadow.png",iconAnchor:[16,37],shadowAnchor:[20,35],popupAnchor:[0,-30]}))});var a}}).addTo(window.lfMap)}},{key:"render",value:function(){return r.a.createElement("div",{id:"map",style:$})}}]),t}(r.a.Component),Z=a(216),ee=a(2),te=a(11),ae=a(120),ne=function(e){var t,a=e.value,n="Fraflytter"===(t=a)?"orange":"Tilflytter"===t?"green":"Nystartet"===t?"blue":"Oph\xf8rt"===t?"red":"blue";return r.a.createElement("b",{style:{color:n}},a)},re=function(e){return r.a.createElement(te.b,Object.assign({formatterComponent:ne},e))},le=function(e){var t=e.value,a="https://datacvr.virk.dk/data/visenhed?enhedstype=produktionsenhed&id=".concat(t);return r.a.createElement("a",{href:a,target:"_blank",rel:"noopener noreferrer"},t)},se=function(e){return r.a.createElement(te.b,Object.assign({formatterComponent:le},e))},oe=function(e){return e.keyIndex},ie=function(e){function t(e){var a;return Object(m.a)(this,t),(a=Object(p.a)(this,Object(g.a)(t).call(this,e))).state={rows:[],data:[],sorting:[{columnName:"hovedbranche",direction:"desc"}],statusColumns:["status"],pcols:["p-nummer"],grouping:[{columnName:"status"}]},a.changeSorting=function(e){return a.setState({sorting:e})},a.changeGrouping=function(e){return a.setState({grouping:e})},a}return Object(v.a)(t,e),Object(h.a)(t,[{key:"componentDidMount",value:function(){}},{key:"componentDidUpdate",value:function(){}},{key:"render",value:function(){var e=this.props.updateData,t=this.props.total,a=this.props.totalRendered,n=this.state.statusColumns,l=this.state.pcols,s=this.props.data.map((function(e,t){e.properties.keyIndex=t;var a=e.properties["fuldt ansvarlige deltagere"];return null!==a&&a.length>0&&(e.properties["fuldt ansvarlige deltagere"]=a.replace(/"/g,"")),"NULL"===a&&(e.properties["fuldt ansvarlige deltagere"]=""),e.properties}));return r.a.createElement(Z.a,{style:{height:"100%"}},r.a.createElement("h6",{style:{textAlign:"center"}},"".concat(a," ud af ").concat(t)),r.a.createElement(ae.a,{rows:s,columns:[{name:"status",title:"Status"},{name:"cvr-nummer",title:"CVR nummer"},{name:"p-nummer",title:"P nummer"},{name:"hovedbranche",title:"Branche"},{name:"virksomhedsform",title:"virksomhedsform"},{name:"navn",title:"Virksomhedsnavn"},{name:"fuldt ansvarlige deltagere",title:"Kontaktperson"},{name:"kvartalbes_interval",title:"Antal ansatte"},{name:"kommunekode",title:"Kommunekode"},{name:"vejnavn",title:"Vejnavn"},{name:"husnummer",title:"Husnummer"},{name:"postnummer",title:"Postnummer"},{name:"postdistrikt",title:"By"},{name:"emailadresse",title:"Email"},{name:"startdato",title:"Startdato cvr"},{name:"indl\xe6st dato",title:"Indl\xe6st dato"}],getRowId:oe,style:{height:"100%"}},r.a.createElement(te.d,{defaultFilters:[]}),r.a.createElement(te.g,null),r.a.createElement(te.k,{defaultSorting:[{columnName:"status",direction:"desc"}]}),r.a.createElement(te.h,null),r.a.createElement(re,{for:n}),r.a.createElement(se,{for:l}),r.a.createElement(ae.e,{height:600}),r.a.createElement(ae.b,{defaultColumnWidths:[{columnName:"status",width:100},{columnName:"cvr-nummer",width:100},{columnName:"p-nummer",width:100},{columnName:"hovedbranche",width:150},{columnName:"virksomhedsform",width:150},{columnName:"navn",width:150},{columnName:"fuldt ansvarlige deltagere",width:120},{columnName:"kvartalbes_interval",width:120},{columnName:"kommunekode",width:120},{columnName:"vejnavn",width:120},{columnName:"husnummer",width:120},{columnName:"postnummer",width:120},{columnName:"postdistrikt",width:120},{columnName:"emailadresse",width:120},{columnName:"startdato",width:120},{columnName:"indl\xe6st dato",width:120}]}),r.a.createElement(ae.d,{showSortingControls:!0}),r.a.createElement(ae.c,null),r.a.createElement(ee.k,{name:"root"},r.a.createElement(ee.l,null,(function(t){var a=t.rows;return console.log("filteredRows"),console.log(a),e(a),r.a.createElement(ee.m,null)})))))}}]),t}(r.a.PureComponent),ce=a(671),ue=a(676),de=a(684),me=a(345),he=function(e){function t(){var e;return Object(m.a)(this,t),(e=Object(p.a)(this,Object(g.a)(t).call(this))).state={clicked:!1,style:{data:{fill:"tomato"}}},e}return Object(v.a)(t,e),Object(h.a)(t,[{key:"render",value:function(){var e=this,t=function(e){var t=e.map((function(e){return e.properties})),a=t.filter((function(e){return"Tilflytter"===e.status})).length;return[{x:"Fraflytter",y:t.filter((function(e){return"Fraflytter"===e.status})).length},{x:"Tilflytter",y:a},{x:"Oph\xf8rt",y:t.filter((function(e){return"Oph\xf8rt"===e.status})).length},{x:"Nystartet",y:t.filter((function(e){return"Nystartet"===e.status})).length}]}(this.props.data);return r.a.createElement("div",null,r.a.createElement(Z.a,{style:{height:800,width:800,margin:"auto"}},r.a.createElement(ce.a,{height:200,width:300,theme:ue.a.material,domainPadding:15},r.a.createElement(de.a,{barWidth:8,dataComponent:r.a.createElement(me.a,{events:{onMouseOver:function(){var t=e.state.clicked?"blue":"tomato",a=!e.state.clicked;e.setState({clicked:a,style:{data:{fill:t}}})}}}),style:{data:{fill:function(e){return"Fraflytter"===e.datum.x?"orange":"Tilflytter"===e.datum.x?"green":"Oph\xf8rt"===e.datum.x?"red":"Nystartet"===e.datum.x?"blue":void 0}}},data:t,labels:function(e){return e.datum.y}}))))}}]),t}(r.a.Component),pe=a(78);function ge(){return r.a.createElement(pe.a,{variant:"h6",color:"inherit"},"CVR Flyttem\xf8nster")}a(485);var fe=a(12),ve=a.n(fe),be=a(166),ke=a.n(be),Ee=a(103),ye=a.n(Ee),we=a(340),Oe=a.n(we),je=a(655),Ce=a(681),De=a(645),Se=a(599),Fe=a(647),xe=a(652),Te=a(657),Le=a(159),Me=a.n(Le),Ne=a(117),Re=a.n(Ne),_e=a(656),Ie=a(673),Ye=Object(je.a)({list:{width:450},fullList:{width:"auto"},nested:{paddingLeft:30}});function Ae(e){var t=Ye(),a=e.handleDrawer,n=e.filterCols,l=e.handleCheckedFilters,s=e.reset,o=e.doFilter,i=e.filterWords,c=r.a.useState({status:!1,postdistrikt:!1,postnummer:!1}),m=Object(u.a)(c,2),h=m[0],p=m[1];return r.a.createElement("div",null,r.a.createElement(Ce.a,{anchor:"right",open:e.drawerOpen,onClose:a},function(e,a){var n={};return e.forEach((function(e){a[e]&&(n[e]=function(e,a){return e[a].map((function(e,n){return r.a.createElement(Se.a,{key:a+"_"+n,button:!0,className:t.nested},r.a.createElement(Fe.a,{primary:Object.keys(e)[0]}),r.a.createElement(_e.a,null,r.a.createElement(Ie.a,{checked:Object.values(e)[0],onChange:function(t){return l(a+"_"+Object.keys(e)[0],t)},edge:"end"})))}))}(a,e))})),r.a.createElement("div",{className:t.list,role:"presentation"},r.a.createElement(De.a,null,r.a.createElement(Se.a,null,r.a.createElement(xe.a,null,r.a.createElement(z.a,{variant:"contained",color:"primary",size:"small",onClick:o},"Filtrere")),r.a.createElement(_e.a,null,r.a.createElement(z.a,{variant:"contained",color:"secondary",size:"small",onClick:s},"Nulstil")))),r.a.createElement(De.a,{dense:!0},e.map((function(e,t){return r.a.createElement(r.a.Fragment,{key:"cat_"+t},r.a.createElement(Se.a,{button:!0,key:e,onClick:function(){return function(e){p(Object(d.a)({},h,Object(b.a)({},e,!h[e])))}(e)}},r.a.createElement(Fe.a,{primary:e}),h[e]?r.a.createElement(Me.a,null):r.a.createElement(Re.a,null)),r.a.createElement(Te.a,{in:h[e],timeout:"auto",unmountOnExit:!0},r.a.createElement(De.a,{component:"div",disablePadding:!0,dense:!0},n[e])))}))))}(i,n)))}var Ve=a(685),Pe=Object(je.a)((function(e){return{root:{flexGrow:1},container:{display:"flex",flexWrap:"wrap"},textField:{marginLeft:e.spacing(1),marginRight:e.spacing(1),width:200}}}));var We=function(e){Pe();var t=e.loginData,a=e.handleLoginDatachange;return r.a.createElement(r.a.Fragment,null,r.a.createElement(R.a,{item:!0,xs:3},r.a.createElement(Ve.a,null,"Brugernavn"),r.a.createElement(N.a,{id:"standard-basic",label:"",name:"user",variant:"standard",placeholder:"",InputLabelProps:{shrink:!1},value:t.user.value,onChange:a})),r.a.createElement(R.a,{item:!0,xs:3},r.a.createElement(Ve.a,null,"Adgangskode"),r.a.createElement(N.a,{type:"password",id:"standard-basic",label:"",name:"password",variant:"standard",value:t.password.value,onChange:a})))},qe=a(660),Be=a(665),Ke=a(662),Ue=a(663),ze=a(661),He=a(664),Ge=a(659);function Je(e){var t=r.a.useState(!1),a=Object(u.a)(t,2),n=(a[0],a[1],r.a.useState({name:{value:"",error:!1,helperText:""},email:{value:"",error:!1,helperText:""},organisation:{value:"",error:!1,helperText:""},password:{value:"",error:!1,helperText:""},password2:{value:"",error:!1,helperText:""},consent:{value:!0,error:!1,helperText:""},btnDisabled:!0})),l=Object(u.a)(n,2),s=l[0],o=l[1],i=function(e){return"password2"===e&&s[e].value.length<2&&s.password.value!==s.password2.value?(console.log(s.password.value," and ",s.password2.value," are not equal"),!0):s[e].value.length<2},c=function(e){var t,a=e.target,n="checkbox"===a.type?a.checked:a.value,r=a.name;o(Object(d.a)({},s,(t={},Object(b.a)(t,r,Object(d.a)({},s[r],{value:n})),Object(b.a)(t,"btnDisabled",i("name")||i("email")||i("organisation")||i("password")||i("password2")||!s.consent.value),t)))},m=e.handleCreateDialogClose;return r.a.createElement("div",null,r.a.createElement(qe.a,{open:e.isRegisterFormShown,onClose:m,"aria-labelledby":"form-dialog-title"},r.a.createElement(ze.a,{id:"form-dialog-title"},"Opret dig som bruger"),r.a.createElement(Ke.a,null,r.a.createElement(Ue.a,null),r.a.createElement(N.a,{autoFocus:!0,margin:"dense",name:"name",id:"name",label:"Navn:",type:"email",value:s.name.value,error:s.name.error,helperText:s.name.helperText,onChange:c,fullWidth:!0}),r.a.createElement(N.a,{autoFocus:!0,margin:"dense",id:"organisation",name:"organisation",label:"Organisation:",type:"email",value:s.organisation.value,onChange:c,error:s.organisation.error,helperText:s.organisation.helperText,fullWidth:!0}),r.a.createElement(N.a,{autoFocus:!0,margin:"dense",id:"email",name:"email",label:"Email Address",type:"email",value:s.email.value,error:s.email.error,helperText:s.email.helperText,onChange:c,fullWidth:!0}),r.a.createElement(N.a,{autoFocus:!0,margin:"dense",id:"password",name:"password",label:"Adganskode:",type:"password",value:s.password.value,error:s.password.error,helperText:s.password.helperText,onChange:c,fullWidth:!0}),r.a.createElement(N.a,{autoFocus:!0,margin:"dense",id:"password2",name:"password2",label:"Gentag adgangskode:",type:"password",value:s.password2.value,error:s.password2.error,helperText:s.password2.helperText,onChange:c,fullWidth:!0}),r.a.createElement(He.a,{control:r.a.createElement(Ie.a,{checked:s.consent.value,name:"consent",onChange:c}),label:"Med min oprettelse som bruger giver jeg mit samtykke til, at mine oplysninger bliver opbevaret, s\xe5ledes at projektet kan kontakte mig, fx. ifm. driftforstyrelser, nye versioner, nye tiltag, mv."}),!s.consent.value&&r.a.createElement(Ge.a,{error:!0},"Du skal give samtykke")),r.a.createElement(Be.a,{style:{justifyContent:"center"}},r.a.createElement(z.a,{disabled:!s.consent.value,variant:"contained",onClick:function(){var t={name:s.name.value,email:s.email.value,organisation:s.organisation.value,password:s.password.value};e.handleRegister(t)},color:"primary"},"Opret"))))}var $e=a(347),Qe=a(650),Xe=a(211),Ze=a.n(Xe),et=Object(O.a)({paper:{border:"1px solid #d3d4d5"}})((function(e){return r.a.createElement($e.a,Object.assign({elevation:0,getContentAnchorEl:null,anchorOrigin:{vertical:"bottom",horizontal:"center"},transformOrigin:{vertical:"top",horizontal:"center"}},e))})),tt=Object(O.a)((function(e){return{root:{"&:focus":{backgroundColor:e.palette.primary.main,"& .MuiListItemIcon-root, & .MuiListItemText-primary":{color:e.palette.common.white}}}}}))(Qe.a);function at(e){var t=r.a.useState(null),a=Object(u.a)(t,2),n=a[0],l=a[1];return r.a.createElement("div",null,r.a.createElement(D.a,{"aria-controls":"customized-menu","aria-haspopup":"true",variant:"contained",color:"primary",onClick:function(e){l(e.currentTarget)}},r.a.createElement(Ze.a,null)),r.a.createElement(et,{id:"customized-menu",anchorEl:n,keepMounted:!0,open:Boolean(n),onClose:function(){l(null)}},r.a.createElement(tt,{onClick:e.handleLogout},r.a.createElement(Fe.a,{primary:"Log ud"}))))}M.a.locale("da");var nt=ke.a.ExcelFile,rt=ke.a.ExcelFile.ExcelSheet,lt=ke.a.ExcelFile.ExcelColumn,st=["status","virksomhedsform","hovedbranche"],ot=Object(x.a)({typography:{useNextVariants:!0,suppressDeprecationWarnings:!0}});function it(e,t){var a={};function n(e,t){var a,n=e.map((function(e){return e[t]})),r=(a=n,Object(k.a)(new Set(a)));return r=r.map((function(e){return Object(b.a)({},e,!1)}))}return t.forEach((function(t){a[t]=n(e,t)})),a}function ct(e){return r.a.createElement("div",null,e.children)}var ut=function(e){function t(e){var a;return Object(m.a)(this,t),(a=Object(p.a)(this,Object(g.a)(t).call(this,e))).state={value:0,startDate:M()().subtract(1,"months").startOf("month").format("YYYY-MM-DD"),endDate:M()().subtract(1,"months").endOf("month").format("YYYY-MM-DD"),data:[],kommuner:[],komkode:a.props.komnr,csvData:[],loading:!0,completed:0,canSendRequest:!1,filterOpen:!1,drawerOpen:!1,alertOpen:!1,alertMessage:"",uniqueVals:{},dataToRender:[],isLoginShown:!0,isRegisterFormShown:!1,sessionId:"",loginData:{user:{value:"",error:!1,helperText:"*"},password:{value:"",error:!1,helperText:"*"}}},a.handleChange=a.handleChange.bind(Object(f.a)(a)),a.handleStart=a.handleStart.bind(Object(f.a)(a)),a.handleEnd=a.handleEnd.bind(Object(f.a)(a)),a.handleSelect=a.handleSelect.bind(Object(f.a)(a)),a.handleDoneClick=a.handleDoneClick.bind(Object(f.a)(a)),a.handleFilterOpen=a.handleFilterOpen.bind(Object(f.a)(a)),a.handleFilterClose=a.handleFilterClose.bind(Object(f.a)(a)),a.handleDrawerOpen=a.handleDrawerOpen.bind(Object(f.a)(a)),a.handleCheckedFilters=a.handleCheckedFilters.bind(Object(f.a)(a)),a.reset=a.reset.bind(Object(f.a)(a)),a.updateRenderDataFromTable=a.updateRenderDataFromTable.bind(Object(f.a)(a)),a.doFilter=a.doFilter.bind(Object(f.a)(a)),a.onAlertClose=a.onAlertClose.bind(Object(f.a)(a)),a.handleCreateDialogOpen=a.handleCreateDialogOpen.bind(Object(f.a)(a)),a.handleCreateDialogClose=a.handleCreateDialogClose.bind(Object(f.a)(a)),a.handleLogin=a.handleLogin.bind(Object(f.a)(a)),a.handleLogout=a.handleLogout.bind(Object(f.a)(a)),a.handleRegister=a.handleRegister.bind(Object(f.a)(a)),a.handleLoginDatachange=a.handleLoginDatachange.bind(Object(f.a)(a)),a}return Object(v.a)(t,e),Object(h.a)(t,[{key:"onAlertClose",value:function(){this.setState({alertOpen:!1})}},{key:"handleLoginDatachange",value:function(e){console.log("I was called!!!");var t=e.target,a=t.value,n=t.name;this.setState({loginData:Object(d.a)({},this.state.loginData,Object(b.a)({},n,Object(d.a)({},this.state.loginData[n],{value:a})))})}},{key:"doFilter",value:function(){var e=this.state.uniqueVals,t=Object.keys(e),a={};t.forEach((function(t){var n=e[t];a[t]=n.filter((function(e){return!0===Object.values(e)[0]})).map((function(e){return Object.keys(e)[0]}))}));var n=this.state.dataToRender.filter((function(e){var n=!0;return t.forEach((function(t){a[t].length>0&&-1===a[t].indexOf(e.properties[t])&&(n=!1)})),n})),r="".concat(n.length," ud af ").concat(this.state.data.length);this.setState({dataToRender:n,drawerOpen:!1,alertMessage:r,alertOpen:!0})}},{key:"updateRenderDataFromTable",value:function(e){this.setState({csvData:e})}},{key:"reset",value:function(){this.setState({dataToRender:this.state.data,uniqueVals:it(this.state.data.map((function(e){return e.properties})),st)})}},{key:"handleCheckedFilters",value:function(e,t){var a=e.split("_"),n=Object(u.a)(a,2),r=n[0],l=n[1],s=this.state.uniqueVals[r],o=s.findIndex((function(e){return Object.keys(e)[0]===l})),i=s[o];i[l]=!i[l],this.setState({uniqueVals:Object(d.a)({},this.state.uniqueVals,Object(b.a)({},r,[].concat(Object(k.a)(s.slice(0,o)),[i],Object(k.a)(s.slice(o+1)))))})}},{key:"handleFilterOpen",value:function(){this.setState({filterOpen:!this.state.filterOpen})}},{key:"handleLogout",value:function(){var e=this;ye.a.get("https://offentligedata.admin.gc2.io/api/v2/session/stop",(function(t){t&&t.success&&(e.setState({sessionId:"",data:[],csvData:[],dataToRender:[]}),window.lfMap&&window.geojsonLayer&&(console.log("removelayer called"),window.lfMap.removeLayer(window.geojsonLayer)))}))}},{key:"handleDrawerOpen",value:function(){this.setState({drawerOpen:!this.state.drawerOpen})}},{key:"handleFilterClose",value:function(){this.setState({filterOpen:!1})}},{key:"getKommuner",value:function(){var e=this;ye.a.ajax({url:"kom.json",type:"GET",dataType:"json",success:function(t){var a=t.features.map((function(e){return e.properties}));e.setState((function(e){return{kommuner:a}}))}})}},{key:"handleLogin",value:function(){var e=this,t={user:e.state.loginData.user.value,password:e.state.loginData.password.value,schema:"ballerup"};ye.a.get("https://offentligedata.admin.gc2.io/api/v2/session/start",t,(function(t){t&&t.success&&(e.setState({sessionId:t.data.session_id}),console.log("login succeeded, session id: ",t.data.session_id))}),"json")}},{key:"handleRegister",value:function(e){var t=this,a={name:e.name,email:e.email,password:e.password,subuser:!0,usergroup:"My group",parentdb:"ballerup",properties:{org:e.organisation}},n={user:e.name,password:e.password,schema:"ballerup"};ye.a.post("https://offentligedata.admin.gc2.io/api/v2/user",JSON.stringify(a),(function(e){console.log("data posted successfully!"),console.log(e),t.handleCreateDialogClose(),e&&e.success&&ye.a.get("https://offentligedata.admin.gc2.io/api/v2/session/start",n,(function(e){e&&e.success&&(t.setState({sessionId:e.data.session_id}),console.log("login succeeded, session id: ",e.data.session_id))}),"json")}),"json"),this.setState({sessionId:"loggedin"})}},{key:"getData",value:function(e,t,a){this.setState((function(e){return{csvData:[],loading:!0}}));var n=this,r={session_id:this.state.sessionId,komkode:e,startdate:t,enddate:a,database:"ballerup"},l=JSON.stringify(r);if(e){ye.a.ajax({url:"https://offentligedata.admin.gc2.io/extensions/offentligedata/api/request",type:"POST",dataType:"json",data:l,success:function(e){var t=e.features.map((function(e){return e.properties}));e.features.forEach((function(e){var t=e.properties.virksomhedsform;e.properties.virksomhedsform=function(e){switch(e){case 10:return"Enkeltmandsvirksomhed";case 15:return"Personligt ejet Mindre Virksomhed";case 20:return"D\xf8dsbo";case 30:return"Interessentskab";case 40:return"Kommanditselskab";case 45:return"Medarbejderinvesteringsselskab";case 50:return"Partrederi";case 60:return"Aktieselskab";case 70:return"Kommanditaktieselskab/Partnerskab";case 80:return"Anpartsselskab";case 81:return"Iv\xe6rks\xe6tterselskab";case 90:return"Fond";case 100:return"Erhvervsdrivende fond";case 110:return"Forening";case 115:return"Frivillig forening";case 130:return"Andelselskab(-forening)";case 140:return"Andelselskab(-forening) med begr\xe6nset ansvar";case 150:return"Forening eller selskab med begr\xe6nset ansvar";case 151:return"Selskab med begr\xe6nset ansvar";case 152:return"Forening med begr\xe6nset ansvar";case 160:return"Europ\xe6isk \xd8konomisk Firmagruppe";case 170:return"Filial af udenlandsk aktieselskab, kommanditakties";case 180:return"Filial af udenlandsk anpartselskab eller selskab";case 190:return"Filial af udenlandsk virksomhed med begr\xe6nset ansv";case 195:return"SCE-selskab";case 196:return"Filial af SCE-selskab";case 200:return"Filial af anden udenlandsk virksomhed";case 210:return"Anden udenlandsk virksomhed";case 220:return"Fast forretningssted af Europ\xe6isk \xf8konomisk Firmag";case 230:case 235:case 245:case 250:return"Offentlige arbejdsplads";case 260:return"Folkekirkelige institutioner";case 270:return"Enhed under oprettelse i Erhvervs- og Selskabsstyr";case 280:return"\xd8vrige virksomhedsformer";case 285:return"S\xe6rlig finansiel virksomhedsform";case 290:return"SE-selskab";case 291:return"Filial af SE-selskab";case 990:return"Uoplyst virksomhedsform";default:return e}}(t);var a=e.properties.startdato;e.properties.startdato=a&&a.length>0?a.substring(0,10):""})),n.setState((function(a){return{csvData:t,data:e.features,dataToRender:e.features,loading:!1,uniqueVals:it(t,st)}}))}})}else this.setState({loading:!1})}},{key:"handleSelect",value:function(e){e.persist(),this.setState((function(t){return{komkode:e.target.value}}))}},{key:"componentDidMount",value:function(){var e=this.state,t=e.komkode,a=e.startDate,n=e.endDate;this.getData(t,a,n),this.getKommuner()}},{key:"componentWillUnmount",value:function(){}},{key:"handleChange",value:function(e,t){this.setState({value:t})}},{key:"handleDoneClick",value:function(){var e=this.state,t=e.komkode,a=e.startDate,n=e.endDate;t||(t=165),this.getData(t,a,n),Object(o.d)("#/"+t)}},{key:"handleStart",value:function(e){this.setState({startDate:e.format("YYYY-MM-DD")})}},{key:"handleEnd",value:function(e){this.setState({endDate:e.format("YYYY-MM-DD")})}},{key:"handleCreateDialogOpen",value:function(){console.log("Createdialog open"),this.setState({isRegisterFormShown:!0,isLoginShown:!1})}},{key:"handleCreateDialogClose",value:function(){this.setState({isRegisterFormShown:!1,isLoginShown:!0})}},{key:"render",value:function(){var e=this.state,t=e.value,a=e.startDate,n=e.endDate,l=e.kommuner,s=e.komkode;return r.a.createElement(T.a,{theme:ot},r.a.createElement("div",{className:"app"},r.a.createElement("div",{className:this.state.loading?"loading":""}),r.a.createElement(Ae,{handleDrawer:this.handleDrawerOpen,drawerOpen:this.state.drawerOpen,filterCols:this.state.uniqueVals,handleCheckedFilters:this.handleCheckedFilters,reset:this.reset,doFilter:this.doFilter,filterWords:st}),r.a.createElement(Je,{handleRegister:this.handleRegister,isRegisterFormShown:this.state.isRegisterFormShown,handleCreateDialogClose:this.handleCreateDialogClose,handleCreateDialogOpen:this.handleCreateDialogOpen}),r.a.createElement("div",{className:""},r.a.createElement(E.a,{position:"static",color:"default"},r.a.createElement(y.a,null,r.a.createElement(R.a,{container:!0},r.a.createElement(R.a,{item:!0,xs:2},r.a.createElement(ge,null)),""===this.state.sessionId&&r.a.createElement(r.a.Fragment,null,r.a.createElement(We,{loginData:this.state.loginData,handleLoginDatachange:this.handleLoginDatachange}),r.a.createElement(R.a,{item:!0,xs:1},r.a.createElement(z.a,{variant:"contained",color:"primary",size:"small",onClick:this.handleLogin},"Log p\xe5")),r.a.createElement(R.a,{item:!0,xs:2},"eller \xa0",r.a.createElement(H.a,{color:"inherit",underline:"always",component:"button",onClick:this.handleCreateDialogOpen,size:"small"},"Opret dig som bruger"))),""!==this.state.sessionId&&r.a.createElement(r.a.Fragment,null,r.a.createElement(R.a,{item:!0,xs:2},r.a.createElement("form",{className:ve.a.container,noValidate:!0,autoComplete:"off"},r.a.createElement(N.a,{id:"standard-select",select:!0,label:"Kommune",placeholder:"Placeholder",className:ve.a.textField,value:this.state.komkode||"",onChange:this.handleSelect,SelectProps:{native:!0},helperText:"",InputLabelProps:{shrink:!0}},l.map((function(e){return r.a.createElement("option",{key:e.komkode,value:e.komkode},e.komnavn)}))))),r.a.createElement(R.a,{item:!0,xs:2},r.a.createElement(K.a,{utils:B.a,locale:"da",moment:M.a},r.a.createElement(U.a,{value:a,label:"Startdato",format:"DD MMM YYYY",onChange:this.handleStart}))),r.a.createElement(R.a,{item:!0,xs:2},r.a.createElement(K.a,{utils:B.a},r.a.createElement(U.a,{value:n,label:"Slutdato",format:"DD MMM YYYY",onChange:this.handleEnd})))),""!==this.state.sessionId&&r.a.createElement(r.a.Fragment,null,r.a.createElement(R.a,{item:!0,xs:3},r.a.createElement(D.a,{"arial-label":"Done",onClick:this.handleDoneClick},r.a.createElement(w.a,{title:"Send"},r.a.createElement(F.a,null))),r.a.createElement(D.a,{"arial-label":"Filter",onClick:this.handleDrawerOpen},r.a.createElement(w.a,{title:"Filter"},r.a.createElement(Oe.a,null))),this.state.csvData.length>0&&r.a.createElement(nt,{element:r.a.createElement(D.a,{"arial-label":"Excel"},r.a.createElement(w.a,{title:"Download Excel"},r.a.createElement(I.a,null))),filename:"export_"+s+"_"+a+"_"+n},r.a.createElement(rt,{data:this.state.csvData,name:"CVR"},r.a.createElement(lt,{label:"Status",value:"status"}),r.a.createElement(lt,{label:"CVR nummer",value:"cvr-nummer"}),r.a.createElement(lt,{label:"P nummer",value:"p-nummer"}),r.a.createElement(lt,{label:"Branche",value:"hovedbranche"}),r.a.createElement(lt,{label:"virksomhedsform",value:"virksomhedsform"}),r.a.createElement(lt,{label:"Virksomhedsnavn",value:"navn"}),r.a.createElement(lt,{label:"Kontaktperson",value:"fuldt ansvarlige deltagere"}),r.a.createElement(lt,{label:"kvartalbes_interval",value:"Antal ansatte"}),r.a.createElement(lt,{label:"Kommunekode",value:"kommunekode"}),r.a.createElement(lt,{label:"vejnavn",value:"vejnavn"}),r.a.createElement(lt,{label:"Husnummer",value:"husnummer"}),r.a.createElement(lt,{label:"Postnummer",value:"postnummer"}),r.a.createElement(lt,{label:"By",value:"postdistrikt"}),r.a.createElement(lt,{label:"Email",value:"emailadresse"}),r.a.createElement(lt,{label:"Indl\xe6st dato",value:"indl\xe6st dato"})))),r.a.createElement(R.a,{item:!0,xs:1},r.a.createElement(at,{handleLogout:this.handleLogout})))))),r.a.createElement(j.a,{value:t,onChange:this.handleChange,centered:!0},r.a.createElement(C.a,{icon:r.a.createElement(w.a,{title:"Kort"},r.a.createElement(A.a,null))}),r.a.createElement(C.a,{icon:r.a.createElement(w.a,{title:"Tabel"},r.a.createElement(P.a,null)),"aria-label":"Tabel"}),r.a.createElement(C.a,{icon:r.a.createElement(w.a,{title:"Histogram"},r.a.createElement(q.a,null))})),0===t&&r.a.createElement(ct,null,r.a.createElement(X,{data:this.state.dataToRender})),1===t&&r.a.createElement(ct,null,r.a.createElement(ie,{data:this.state.dataToRender,updateData:this.updateRenderDataFromTable,total:this.state.data.length,totalRendered:this.state.csvData.length})),2===t&&r.a.createElement(ct,null,r.a.createElement(he,{data:this.state.dataToRender})))))}}]),t}(n.Component),dt=Object(O.a)((function(e){return{root:{flexGrow:1},container:{display:"flex",flexWrap:"wrap"},textField:{marginLeft:e.spacing(1),marginRight:e.spacing(1),width:200},dense:{marginTop:19},menu:{width:300},progress:{margin:2*e.spacing(1)},nested:{paddingLeft:e.spacing(4)}}}))(ut),mt=c()(),ht=Object(o.c)(mt),pt=function(){return r.a.createElement(o.a,{history:ht},r.a.createElement(o.b,null,r.a.createElement(dt,{path:"/"}),r.a.createElement(dt,{path:"/:komnr"})))};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));s.a.render(r.a.createElement(pt,null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()}))}},[[367,1,2]]]);
//# sourceMappingURL=main.c6ccb468.chunk.js.map